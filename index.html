<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Boxe Tool Minimal</title>
</head>
<body>

    <h1>Liste des Boxeurs dans le listener bouton</h1>


    <script>
        const SUPABASE_URL = 'https://uxrfrtmahfymwuxgprsd.supabase.co/rest/v1/Boxeurs?select=LastName,FirstName';
        const API_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InV4cmZydG1haGZ5bXd1eGdwcnNkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0MDUzMTksImV4cCI6MjA4MDk4MTMxOX0.ge8mWR-cejDTxPC2zTm-Xl1eBma1KWro8-SEzM8zblk';

        async function getBoxeurs() {
            try {
                const res = await fetch(SUPABASE_URL, {
                    headers: {
                        "apikey": API_KEY,
                        "Authorization": "Bearer " + API_KEY
                    }
                });
                return await res.json();
            } catch (error) {
                console.error("Erreur fetch Supabase :", error);
                return [];
            }
        }

        function afficherBoxeurs(boxeurs) {
            const resultDiv = document.getElementById("result");
            resultDiv.innerHTML = ""; // Vide avant affichage
            boxeurs.forEach(b => {
                const div = document.createElement("div");
                div.textContent = `${b.FirstName || ''} ${b.LastName || ''}`;
                resultDiv.appendChild(div);
            });
        }

        // --- Bouton pour déclencher le fetch ---
        window.addEventListener("DOMContentLoaded", () => {
            const bouton = document.createElement("button");
            bouton.textContent = "Afficher les boxeurs";
            document.body.appendChild(bouton);

            const resultDiv = document.createElement("div");
            resultDiv.id = "result";
            resultDiv.style.marginTop = "20px";
            resultDiv.style.fontWeight = "bold";
            document.body.appendChild(resultDiv); // <-- div après le bouton

            bouton.addEventListener("click", async () => {
                const boxeurs = await getBoxeurs();
                afficherBoxeurs(boxeurs);
            });
        });

    </script>

    <h1>Liste des boxeurs depuis un champ déroulant.</h1>

    <!-- Champ déroulant -->
    <label for="boxeurSelect">Choisissez un boxeur :</label>
    <select id="boxeurSelect">
        <option value="">-- Sélectionnez --</option>
    </select>

    <!-- Bouton pour tester la sélection -->
    <button id="showSelected">Afficher le boxeur choisi</button>
    <div id="selectedResult"></div>

    <script>
        const select = document.getElementById('boxeurSelect');
        const result = document.getElementById('selectedResult');

        // Fetch des boxeurs depuis Supabase
        async function loadBoxeurs() {
            const { data, error } = await supabase
                .from('boxeurs')
                .select('id, LastName, FirstName'); // récupère id, nom et prénom

            if (error) {
                console.error(error);
                return;
            }

            // Remplir le select
            data.forEach(boxeur => {
                const option = document.createElement('option');
                option.value = boxeur.id;            // id en valeur
                option.text = `${boxeur.LastName} ${boxeur.FirstName}`; // affichage nom + prénom
                select.appendChild(option);
            });
        }

        // Tester la sélection
        document.getElementById('showSelected').addEventListener('click', () => {
            const selectedId = select.value;
            const selectedText = select.options[select.selectedIndex].text;
            result.innerText = `ID: ${selectedId}, Nom: ${selectedText}`;
        });

        // Charger les boxeurs au chargement de la page
        loadBoxeurs();
    </script>



</body>
</html>
